<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã½ã¡ã½ã¡ã™ã‚‹ã ã‘ã§ã‚°ãƒ©ãƒ•ãŒä½œã‚Œã‚‹</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/10.6.0/math.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #333;
        }

        h1 {
            color: #4CAF50;
            margin-top: 20px;
            font-size: 2.5rem;
        }

        section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin: 20px;
            max-width: 800px;
            width: 100%;
        }

        label {
            font-weight: bold;
            margin-bottom: 8px;
            display: block;
            color: #4CAF50;
        }
        input[type="color"] {
            width: 10%; /* è‡ªå‹•ã§å¹…ã‚’èª¿æ•´ */
            padding: 0;  /* ä¸è¦ãªãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–ã‚Šé™¤ã */
            border: none; /* ãƒœãƒ¼ãƒ€ãƒ¼ã‚’ãªãã™ */
            background-color: transparent; /* èƒŒæ™¯ã‚’é€æ˜ã« */
        }
        input, select, button {
            padding: 12px;
            border-radius: 4px;
            border: 1px solid #ddd;
            margin-bottom: 16px;
            width: 100%;
            box-sizing: border-box;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus, button:focus {
            border-color: #4CAF50;
            outline: none;
        }

        button {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:disabled {
            background-color: #ddd;
            cursor: not-allowed;
        }

        button:hover:enabled {
            background-color: #45a049;
        }

        textarea {
            width: 100%;
            height: 200px;
            padding: 10px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 1rem;
            resize: none;
        }

        @media (max-width: 768px) {
            section {
                padding: 20px;
            }

            h1 {
                font-size: 2rem;
            }

            button {
                padding: 10px;
            }
        }
        #copy-message {
          margin-bottom: 20px; /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ä¸Šã«ä½™ç™½ã‚’è¿½åŠ  */
          font-weight: bold;
          color: green; /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è‰² */
          text-align: center;
      }
      .indent {
          padding-left: 20px; /* å·¦ã«20pxã®ä½™ç™½ã‚’è¿½åŠ  */
      }
    </style>
</head>
<body>
    <h1>ã½ã¡ã½ã¡ã™ã‚‹ã ã‘ã§ã‚°ãƒ©ãƒ•ãŒä½œã‚Œã‚‹</h1>
    <section>
<div style="margin-bottom: 10px;">
    <label for="settings-search" style="color: #2e7d32;">ğŸ” è¨­å®šé …ç›®ã‚’æ¤œç´¢:</label>
    <input type="text" id="settings-search" placeholder="ä¾‹: ãƒãƒ¼ã‚«ãƒ¼, ã‚µã‚¤ã‚º, ãƒ•ã‚©ãƒ³ãƒˆ..." 
           style="border: 2px solid #4CAF50;" oninput="filterSettings()">
</div>
        <p>æ³¨æ„:!ãŒã¤ã„ã¦ã„ã‚‹ã‚‚ã®ã¯é–“é•ã£ãŸè¨­å®šã‚’ã™ã‚‹ã¨ã€ã‚°ãƒ©ãƒ•ãŒæç”»ã•ã‚Œãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</p>
        <label for="csv-input"  title="ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãªã‚‰å³ä¸Šã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«â†’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‹ã‚‰CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚">CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰:</label>
        <input type="file" id="csv-input" accept=".csv" title="ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãªã‚‰å³ä¸Šã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«â†’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‹ã‚‰CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚">

        <label for="x-select" title="Xè»¸(æ¨ª)ã¨ã—ãŸã„åˆ—ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚åˆ¶å¾¡ã—ã¦å¤‰åŒ–ã•ã›ãŸãƒ‡ãƒ¼ã‚¿ï¼ˆæ™‚é–“ãªã©ï¼‰ã‚’æ›¸ãã®ãŒæ™®é€šã§ã™ã€‚ç°¡å˜ã«ã„ã†ã¨ã€Œå…¥åŠ›ã€ã§ã™ã€‚">Xè»¸ã®åˆ—ã‚’é¸æŠ:</label>
        <select id="x-select" title="Xè»¸(æ¨ª)ã¨ã—ãŸã„åˆ—ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚åˆ¶å¾¡ã—ã¦å¤‰åŒ–ã•ã›ãŸãƒ‡ãƒ¼ã‚¿ï¼ˆæ™‚é–“ãªã©ï¼‰ã‚’æ›¸ãã®ãŒæ™®é€šã§ã™ã€‚ç°¡å˜ã«ã„ã†ã¨ã€Œå…¥åŠ›ã€ã§ã™ã€‚" disabled>
            <option value="">CSVã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„</option>
        </select>

        <label for="y-select" title="Yè»¸(ç¸¦)ã¨ã—ãŸã„åˆ—ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚åˆ¶å¾¡ã—ã¦ã„ãªã„ã®ã«å¤‰åŒ–ã—ãŸãƒ‡ãƒ¼ã‚¿ï¼ˆæ¸©åº¦ãªã©ï¼‰ã‚’æ›¸ãã®ãŒæ™®é€šã§ã™ã€‚ç°¡å˜ã«ã„ã†ã¨ã€Œå‡ºåŠ›ã€ã§ã™ã€‚">Yè»¸ã®åˆ—ã‚’é¸æŠ:</label>
        <select id="y-select" title="Yè»¸(ç¸¦)ã¨ã—ãŸã„åˆ—ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚åˆ¶å¾¡ã—ã¦ã„ãªã„ã®ã«å¤‰åŒ–ã—ãŸãƒ‡ãƒ¼ã‚¿ï¼ˆæ¸©åº¦ãªã©ï¼‰ã‚’æ›¸ãã®ãŒæ™®é€šã§ã™ã€‚ç°¡å˜ã«ã„ã†ã¨ã€Œå‡ºåŠ›ã€ã§ã™ã€‚" disabled>
            <option value="">CSVã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„</option>
        </select>

        <label for="x-axis-name" title="Xè»¸ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ã‚°ãƒ©ãƒ•ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚">Xè»¸ã®åå‰:</label>
        <input type="text" id="x-axis-name" placeholder="ä¾‹: æ™‚é–“[min]" title="Xè»¸ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ã‚°ãƒ©ãƒ•ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚" disabled>
  

        <label for="y-axis-name" title="Yè»¸ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ã‚°ãƒ©ãƒ•ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚">Yè»¸ã®åå‰:</label>
        <input type="text" id="y-axis-name" placeholder="ä¾‹: æ¸©åº¦[â„ƒ]" title="Yè»¸ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ã‚°ãƒ©ãƒ•ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚" disabled>

        <label for="graph-title" title="ã‚°ãƒ©ãƒ•ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ã‚°ãƒ©ãƒ•ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚">ã‚°ãƒ©ãƒ•ã®ã‚¿ã‚¤ãƒˆãƒ«:</label>
        <input type="text" id="graph-title" placeholder="ä¾‹: å¸ç†±åå¿œã®æ™‚é–“ã¨æ¸©åº¦ã®é–¢ä¿‚" title="ã‚°ãƒ©ãƒ•ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ã‚°ãƒ©ãƒ•ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚" disabled>
<details class="indent">
<summary>è©³ç´°ãªè¨­å®šï¼ˆã‚¯ãƒªãƒƒã‚¯ã§é–‹/é–‰ï¼‰</summary>
        <label for="show-import-settings">!ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¨­å®š:</label>
        <select id="show-import-settings" disabled>
          <option value="show">è¡¨ç¤ºã™ã‚‹</option>
          <option value="hide">è¡¨ç¤ºã—ãªã„</option>
        </select>
        <label for="x-range">Xè»¸ã®ç¯„å›²:</label>
        <input type="text" id="x-range" placeholder="ä¾‹: 1-100" disabled>
        <label for="y-range">Yè»¸ã®ç¯„å›²:</label>
        <input type="text" id="y-range" placeholder="ä¾‹: 1-100" disabled>
        <label for="trendline">ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®ç¨®é¡:</label>
        <select id="trendline" disabled>
            <option value="none">ãªã—</option>
            <option value="linear">ç·šå½¢(æ¯”ä¾‹ã™ã‚‹ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿)</option>
            <option value="quadratic">2æ¬¡(2ä¹—ã«æ¯”ä¾‹ã™ã‚‹ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿)</option>
            <option value="logarithmic">å¯¾æ•°(å¯¾æ•°ã«æ¯”ä¾‹ã™ã‚‹ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿)</option>
        </select>

        <label for="graph-xsize">ã‚°ãƒ©ãƒ•ã®æ¨ª(Xè»¸)ã®å¤§ãã•:</label>
        <input type="text" id="graph-xsize" placeholder="ä¾‹: 16" disabled>

        <label for="graph-ysize">ã‚°ãƒ©ãƒ•ã®ç¸¦(Yè»¸)ã®å¤§ãã•:</label>
        <input type="text" id="graph-ysize" placeholder="ä¾‹: 9" disabled>
        <label for="hanrei-settings">å‡¡ä¾‹ã®è¨­å®š:</label>
        <select id="hanrei-settings" disabled>
          <option value="show">è¡¨ç¤ºã™ã‚‹</option>
          <option value="hide">è¡¨ç¤ºã—ãªã„</option>
        </select>
        <label for="marker-color">ãƒãƒ¼ã‚«ãƒ¼ã®è‰²:</label>
        <input type="color" id="marker-color" value="#1f77b4" disabled>
        <label for="trendline-color">ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®è‰²:</label>
        <input type="color" id="trendline-color" value="#d62728" disabled>
        <label for="marker-size">ãƒãƒ¼ã‚«ãƒ¼ã®ã‚µã‚¤ã‚º:</label>
        <input type="text" id="marker-size" value="20" disabled>
        <label for="font-size-t">ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºï¼ˆã‚¿ã‚¤ãƒˆãƒ«ï¼‰:</label>
        <input type="text" id="font-size-t" value="12" disabled>
        <label for="font-size-x">ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºï¼ˆXè»¸ãƒ»Xè»¸ã®ãƒ©ãƒ™ãƒ«ï¼‰:</label>
        <input type="text" id="font-size-x" value="10" disabled>
        <label for="font-size-y">ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºï¼ˆYè»¸ãƒ»Yè»¸ã®ãƒ©ãƒ™ãƒ«ï¼‰:</label>
        <input type="text" id="font-size-y" value="10" disabled>
        <label for="font-size-xm">ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºï¼ˆXè»¸ã®ç›®ç››ã‚Šï¼‰:</label>
        <input type="text" id="font-size-xm" value="10" disabled>
        <label for="font-size-ym">ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºï¼ˆYè»¸ã®ç›®ç››ã‚Šï¼‰:</label>
        <input type="text" id="font-size-ym" value="10" disabled>
</details><br>
        <button id="generate-btn" disabled>Pythonã®ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹</button>
        <h3>Pythonã®ã‚³ãƒ¼ãƒ‰(Colaboratoryå°‚ç”¨):</h3>
        <div id="copy-message" style="display: none; margin-bottom: 10px; color: green;">ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼</div><button id="copy-button">ã‚³ãƒ”ãƒ¼</button>
        <pre><code id="python-code" class="language-python">
# Pythonã‚³ãƒ¼ãƒ‰ã¯ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™
        </code></pre>
      
    </section>
<hr style="margin-top: 40px; border: 0; border-top: 1px solid #eee;">
<footer style="text-align: center; color: #666; font-size: 0.8em; margin-bottom: 20px;">
    <p>Â© 2025-2026 kouryou-118103 (kouryou118103)</p>

    <p>
        ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢æœ¬ä½“: 
        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ja" target="_blank" rel="noopener noreferrer" style="color: #2e7d32; text-decoration: none; font-weight: bold;">
            CC BY-NC-SA 4.0
        </a>
    </p>
    <p style="margin-top: 5px; font-size: 0.9em;">
        <strong>ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã®æ‰±ã„:</strong>
    </p>
    <p style="font-size: 0.9em;">
        æœ¬ã‚¢ãƒ—ãƒªã§ç”Ÿæˆã•ã‚ŒãŸPythonã‚³ãƒ¼ãƒ‰ã¯ <strong>CC0 (ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ‰ãƒ¡ã‚¤ãƒ³)</strong> ã§ã™ã€‚è‡ªç”±ã«ã”åˆ©ç”¨ãã ã•ã„ã€‚
    </p>
    <p style="display: inline-block; margin-top: 5px; color: #888; font-size: 0.9em;">
        â€»ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®åé›†ã‚„æ‚ªæ„ã®ã‚ã‚‹åˆ©ç”¨ãƒ»æ”¹å¤‰ãªã©ã¯è¡Œã£ã¦ã„ã¾ã›ã‚“ã€‚ä¸‡ä¸€å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã§ã‚‚ã€ä½œè€…ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚<br>
        ãƒã‚°å ±å‘Šã‚„ææ¡ˆãªã©ã¯<a href="https://github.com/kouryou-118103/poti-graph/issues" target="_blank" rel="noopener noreferrer" style="color: #2e7d32; text-decoration: underline;">ã“ã¡ã‚‰ï¼ˆGitHub Issuesï¼‰</a>ã‚ˆã‚ŠãŠé¡˜ã„ã—ã¾ã™ã€‚
    </p>
</footer>
<script>
        document.getElementById('csv-input').addEventListener('change', handleFileUpload);
        document.getElementById('generate-btn').addEventListener('click', generatePythonCode);

        let csvData = [];
        let pythonCode =`# Pythonã‚³ãƒ¼ãƒ‰ã¯ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™`
        
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = () => {
                const lines = reader.result.split('\n').filter(line => line.trim());
                csvData = lines.map(line => line.split(',').map(cell => cell.trim()));

                populateColumnSelects(csvData[0]);
            };
            reader.readAsText(file);
        }

        function populateColumnSelects(headers) {
            const xSelect = document.getElementById('x-select');
            const ySelect = document.getElementById('y-select');

            xSelect.innerHTML = '';
            ySelect.innerHTML = '';

            headers.forEach((header, index) => {
                const optionX = document.createElement('option');
                optionX.value = index;
                optionX.textContent = header;

                const optionY = optionX.cloneNode(true);

                xSelect.appendChild(optionX);
                ySelect.appendChild(optionY);
            });

            xSelect.disabled = false;
            ySelect.disabled = false;
            document.getElementById('x-range').disabled = false;
            document.getElementById('y-range').disabled = false;
            document.getElementById('x-axis-name').disabled = false;
            document.getElementById('y-axis-name').disabled = false;
            document.getElementById('graph-title').disabled = false;
            document.getElementById('generate-btn').disabled = false;
            document.getElementById('graph-xsize').disabled = false;
            document.getElementById('graph-ysize').disabled = false;
            document.getElementById('marker-size').disabled = false;
            document.getElementById('trendline-color').disabled = false;
            document.getElementById('marker-color').disabled = false;
            document.getElementById('font-size-t').disabled = false;
            document.getElementById('font-size-x').disabled = false;
            document.getElementById('font-size-y').disabled = false;
            document.getElementById('font-size-xm').disabled = false;
            document.getElementById('font-size-ym').disabled = false;
            document.getElementById('trendline').disabled = false;
            document.getElementById('hanrei-settings').disabled = false;
            document.getElementById('show-import-settings').disabled = false;
        }

function generatePythonCode() {
        let xRangeInput = document.getElementById('x-range').value;
        let yRangeInput = document.getElementById('y-range').value;
        let trendlineType = document.getElementById('trendline').value;
        let sizeX = document.getElementById('graph-xsize').value;
        let sizeY = document.getElementById('graph-ysize').value;
        let importSetting = document.getElementById('show-import-settings').value;
        let hanrei = document.getElementById('hanrei-settings').value;
        let markerC = document.getElementById('marker-color').value||"#1f77b4";
        let markerT = document.getElementById('trendline-color').value||"#d62728";
        let markerSize = document.getElementById('marker-size').value||20;

        let sizeTitle = document.getElementById('font-size-t').value||12;
        let fontsizeX = document.getElementById('font-size-x').value||10;
        let fontsizeY = document.getElementById('font-size-y').value||10;
        let fontsizemX = document.getElementById('font-size-xm').value||10;
        let fontsizemY = document.getElementById('font-size-ym').value||10;

        let xAxisName = document.getElementById('x-axis-name').value || 'åç§°æœªè¨­å®š(Xè»¸)';
        let yAxisName = document.getElementById('y-axis-name').value || 'åç§°æœªè¨­å®š(Yè»¸)';
        let graphTitle = document.getElementById('graph-title').value || 'åç§°æœªè¨­å®šãªã‚°ãƒ©ãƒ•';

        const xIndex = document.getElementById('x-select').value;
        const yIndex = document.getElementById('y-select').value;
    if (!xIndex || !yIndex) {
        alert('Xè»¸ã¨Yè»¸ã®åˆ—ã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
    }

    // xData ã¨ yData ã®åé›†
    const xData = [];
    const yData = [];

    for (let i = 1; i < csvData.length; i++) {
        const xValue = parseFloat(csvData[i][xIndex]);
        const yValue = parseFloat(csvData[i][yIndex]);

        // ç¯„å›²å¤–ã®ãƒ‡ãƒ¼ã‚¿ã‚‚å«ã‚ã¦è¿½åŠ 
        xData.push(xValue);
        yData.push(yValue);
    }

    if (xData.length === 0 || yData.length === 0) {
        alert('é¸æŠã—ãŸç¯„å›²ã«æœ‰åŠ¹ãªæ•°å€¤ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“');
        return;
    }
    pythonCode = ``
    if (importSetting!=="hide"){
    pythonCode += `!pip install japanize-matplotlib
import japanize_matplotlib  # æ—¥æœ¬èªã‚’è¡¨ç¤ºã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
import matplotlib.pyplot as plt
import numpy as np
# ã“ã®ä¸Š4è¡Œã¯2å›ç›®ä»¥é™ã®å®Ÿè¡Œã§ã¯ä¸è¦(å†èª­ã¿è¾¼ã¿å¾Œã¯å†ã³å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹)

`;
}
    pythonCode += `# ã‚°ãƒ©ãƒ•ã®ãƒ‡ãƒ¼ã‚¿
x_data = ${JSON.stringify(xData)}
y_data = ${JSON.stringify(yData)}

# æ•£å¸ƒå›³ã®ä½œæˆ
plt.scatter(x_data, y_data,color='${markerC}',s=${markerSize})
`
if ((sizeX && !sizeY) || (!sizeX && sizeY)) {
    alert("ã‚°ãƒ©ãƒ•ã®å¤§ãã•ã¯ç¸¦ã¨æ¨ªã®ä¸¡æ–¹ã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ï¼ˆå‡ºåŠ›ã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã«ã¯å¤§ãã•ã®è¨­å®šã¯å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ï¼‰")
}else if(sizeX){
  pythonCode+=`
#ã‚°ãƒ©ãƒ•ã®ã‚µã‚¤ã‚ºã‚’æ±ºã‚ã‚‹
plt.figure(figsize=(${sizeX}, ${sizeY}))
`
}
    // ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®å‡¦ç†ï¼ˆé¸æŠã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰
    pythonCode += generatePythonTrendlineCode(trendlineType, xData, yData);

    // ç¯„å›²ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚Œã°ã€ãã®ç¯„å›²ã‚’è¨­å®š
    if (xRangeInput) {
        const [xMin, xMax] = parseRange(xRangeInput);
        if (xMin !== null && xMax !== null) {
pythonCode += `
# Xè»¸ã®ç¯„å›²è¨­å®š
plt.xlim(${xMin}, ${xMax})
        `;
        }
    }

    if (yRangeInput) {
        const [yMin, yMax] = parseRange(yRangeInput);
        if (yMin !== null && yMax !== null) {
            pythonCode += `
# Yè»¸ã®ç¯„å›²è¨­å®š
plt.ylim(${yMin}, ${yMax})
            `;
        }
    }
if (hanrei=="hide"){
  pythonCode += `
#å‡¡ä¾‹ã‚’éè¡¨ç¤ºã«ã™ã‚‹
plt.legend().set_visible(False)
`
}
    pythonCode += `
plt.xticks(fontsize=${fontsizemX})
plt.yticks(fontsize=${fontsizemY})
plt.xlabel("${xAxisName}",fontsize=${fontsizeX})
plt.ylabel("${yAxisName}",fontsize=${fontsizeY})
plt.title("${graphTitle}",fontsize=${sizeTitle})
plt.show()`;

    document.getElementById('python-code').textContent = pythonCode;
    Prism.highlightAll();
}

// ç¯„å›²ã‚’å‡¦ç†ã™ã‚‹é–¢æ•°ï¼ˆä¾‹: "10-20" -> [10, 20]ï¼‰
function parseRange(rangeInput) {
    const rangeParts = rangeInput.split('-');
    if (rangeParts.length === 2) {
        const start = parseFloat(rangeParts[0]);
        const end = parseFloat(rangeParts[1]);
        if (!isNaN(start) && !isNaN(end)) {
            return [start, end];
        }
    }
    return [null, null];  // ç¯„å›²ãŒæ­£ã—ããªã„å ´åˆï¼ˆã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯}
}
      
function generatePythonTrendlineCode(trendlineType, xData, yData) {
    let markerT = document.getElementById('trendline-color').value||"#d62728";
    if (trendlineType === 'linear') {
        return `
# ä¸€æ¬¡é–¢æ•°ã®ãƒ•ã‚£ãƒƒãƒˆ
coefficients = np.polyfit(x_data, y_data, 1)
polynomial = np.poly1d(coefficients)
# Xè»¸ã®ç¯„å›²ã‚’è¨­å®š
x_range = np.linspace(min(x_data), max(x_data), 500)
# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚ŒãŸæ›²ç·šã‚’è¨ˆç®—
fitted_curve = polynomial(x_range)
plt.plot(x_range, fitted_curve, color='${markerT}', label='ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³');
plt.legend();
        `;
    } else if (trendlineType === 'quadratic') {
        return `
# äºŒæ¬¡é–¢æ•°ã®ãƒ•ã‚£ãƒƒãƒˆ
coefficients = np.polyfit(x_data, y_data, 2)
polynomial = np.poly1d(coefficients)
# Xè»¸ã®ç¯„å›²ã‚’è¨­å®š
x_range = np.linspace(min(x_data), max(x_data), 500)
# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚ŒãŸæ›²ç·šã‚’è¨ˆç®—
fitted_curve = polynomial(x_range)
plt.plot(x_range, fitted_curve, color='${markerT}', label='ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³');
plt.legend();
        `;
    } else if (trendlineType === 'logarithmic') {
        return `
# ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦logã‚’å–ã‚‹
log_x_data = np.log(x_data)

# å¯¾æ•°å¤‰æ›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
coefficients_log = np.polyfit(log_x_data, y_data, 1)
polynomial_log = np.poly1d(coefficients_log)
# Xè»¸ã®ç¯„å›²ã‚’è¨­å®š
x_range = np.linspace(min(x_data), max(x_data), 500)
# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚ŒãŸæ›²ç·šã‚’è¨ˆç®—ï¼ˆå¯¾æ•°å¤‰æ›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã§è¨ˆç®—ï¼‰
log_x_range = np.log(x_range)
fitted_curve_log = polynomial_log(log_x_range)

plt.plot(x_range, fitted_curve_log, color='${markerT}', label='ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³');
plt.legend();
        `;
    }
    return '';
}
// ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹é–¢æ•°
function copyToClipboard() {
    // ä¸€æ™‚çš„ãªtextareaã‚’ä½œæˆ
    var textArea = document.createElement('textarea');
    textArea.value = pythonCode; // pythonCodeã®å†…å®¹ã‚’è¨­å®š
    document.body.appendChild(textArea);
    
    // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®å†…å®¹ã‚’é¸æŠã—ã¦ã‚³ãƒ”ãƒ¼
    textArea.select();
    document.execCommand('copy');
    
    // ä½œæˆã—ãŸtextareaã‚’å‰Šé™¤
    document.body.removeChild(textArea);
    
    // ã‚³ãƒ”ãƒ¼å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
    var message = document.getElementById('copy-message');
    message.style.display = 'block';  // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
    
    // 3ç§’å¾Œã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤ºã«ã™ã‚‹
    setTimeout(function() {
        message.style.display = 'none';
    }, 3000);
}

// ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã«ã‚³ãƒ”ãƒ¼ã‚’å®Ÿè¡Œ
document.getElementById('copy-button').addEventListener('click', copyToClipboard);

function filterSettings() {
    let rawQuery = document.getElementById('settings-search').value;

    // ã²ã‚‰ãŒãªã‚’ã‚«ã‚¿ã‚«ãƒŠã«å¤‰æ›ã™ã‚‹é–¢æ•°
    const hiraToKana = (str) => {
        return str.replace(/[ã-ã‚“]/g, (s) => {
            return String.fromCharCode(s.charCodeAt(0) + 0x60);
        });
    };

    const query = rawQuery.toLowerCase();
    const kanaQuery = hiraToKana(rawQuery).toLowerCase();

    const allLabels = document.querySelectorAll('label');
    const detailsElement = document.querySelector('details.indent');
    const summaryElement = detailsElement.querySelector('summary');
    const isSearching = query.length > 0;

    if (isSearching) {
        if (summaryElement) summaryElement.style.display = "none"; 
        if (detailsElement) {
            detailsElement.open = true;
            detailsElement.style.paddingLeft = "0";
            detailsElement.style.border = "none";
        }
    } else {
        if (summaryElement) summaryElement.style.display = ""; 
        if (detailsElement) {
            detailsElement.open = false;
            detailsElement.style.paddingLeft = "";
            detailsElement.style.border = "";
        }
    }

    allLabels.forEach(label => {
        // æ¤œç´¢çª“è‡ªä½“ã®ãƒ©ãƒ™ãƒ«ã¯ç„¡è¦–
        if (label.getAttribute('for') === 'settings-search') return;

        const targetId = label.getAttribute('for');
        const inputElement = document.getElementById(targetId);
        const labelText = label.textContent.toLowerCase();

        if (labelText.includes(query) || labelText.includes(kanaQuery)) {
            label.style.display = "block";
            if (inputElement) {
                inputElement.style.display = "block";
                inputElement.style.marginBottom = "8px"; // å°‘ã—ä½™ç™½ã‚’ç©ºã‘ã‚‹
            }
        } else {
            label.style.display = "none";
            if (inputElement) inputElement.style.display = "none";
        }
    });
}

    </script>
</body>
</html>
